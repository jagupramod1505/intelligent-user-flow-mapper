<!DOCTYPE html>
<html>
<head>
    <title>User Flow UI</title>
    <style>
        body {
            font-family: Arial;
            padding: 20px;
        }
        .flow-row {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .box {
            border: 2px solid #333;
            padding: 10px 15px;
            border-radius: 8px;
            background: #f5f5f5;
            margin-right: 8px;
            min-width: 120px;
            text-align: center;
        }
        .arrow {
            margin-right: 8px;
            font-weight: bold;
        }
    </style>
</head>

<body>

<h2>Intelligent User Flow Mapper</h2>

<input id="url" value="https://books.toscrape.com" style="width:400px;">
<button onclick="loadFlow()">Show Flow</button>

<h3>User Journeys</h3>
<div id="flows"></div>

<script>
async function loadFlow(){
  const res = await fetch("http://127.0.0.1:8000/crawl", {
    method: "POST",
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify({
      start_url: document.getElementById("url").value,
      max_depth: 2
    })
  });

  const data = await res.json();
  const container = document.getElementById("flows");
  container.innerHTML = "";

  data.flows.forEach(flow => {
      let row = document.createElement("div");
      row.className = "flow-row";

      flow.steps.forEach((step, index) => {
          let box = document.createElement("div");
          box.className = "box";
          box.innerText = step.label;
          row.appendChild(box);

          if (index < flow.steps.length - 1) {
              let arrow = document.createElement("div");
              arrow.className = "arrow";
              arrow.innerText = "â†’";
              row.appendChild(arrow);
          }
      });

      container.appendChild(row);
  });
}
</script>

</body>
</html>
